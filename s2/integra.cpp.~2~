#include <iostream>
#include <cmath>
#include <fstream>
#include <cstdlib>
#include "s2_header.h"

using namespace std;


double integra_rect(double a, double b, int N, double (*f)(double x))
{
  double dx = (double)((b - a)/N);
  double x1, x2, x_med, sum;
  
  sum = 0;
  x1 = a;
  
  for (int i = 0; i < N; i++)
    {
      x2 = x1 + dx;
      x_med = (x1 + x2)/2;
      sum += ((*f)(x_med)) * dx;
      x1 = x2;
    }

  return sum;
}

double integra_trap(double a, double b, int N, double (*f)(double x))
{
   double dx = (double)((b - a)/N);
   double x1, x2, sum;

   sum = 0;
   x1 = a;
    
  for (int i = 0; i < N; i++)
    {
      x2 = x1 + dx;
      sum += (((*f)(x1) + (*f)(x2))/2) * dx;
      x1 = x2;
    }

  return sum;
}

double integra_simp(double a, double b, int N, double (*f)(double x))
{
  double h, sum;

  if (N % 2 != 0)
    {
      cout << "Erro no MÃ©todo de Simpson. N deve ser par!" << endl;
      exit(EXIT_FAILURE);
    }

  h = (double)((b - a)/N);
  sum = (*f)(a) + (*f)(b);


  for (int i = 1; i <= N; i += 2)
    {
      sum += 4 * (*f)(a + i * h);
    }

  for (int j = 2; j <= (N - 1); j += 2)
    {
      sum += 2 * (*f)(a + j * h);
    }

  return (sum * h) / 3;
}
